# eva-instagram

This connector has been created using Instagram API, it shows how to incorporate eva conversational flow.

This application is a Spring Boot app and uses the Azure Kubernetes Service (AKS) to deploy to Azure.

## 1. Requeriments
- Facebook developers account
- Instagram enterprise account
- eva bot

## 2. Configuration

**- Facebook Configuration**
1. First of all, it is necessary to have a business app created at https://developers.facebook.com/ and click the option **My Apps**.
![](https://i.ibb.co/khcb12V/01.png=200x)

2. Once the app is open, inside the panel, look for the Instagram Grap API and select Configure. In the left bar, select the option Messenger and then, Instagram setup. 
![](https://i.ibb.co/swHLBRK/02.png)

3. In Token access, select the facebook page and instagram channel you want to connect. The Instagram account must be previously linked to a Facebook page. You can only link Instagram accounts that are business. 
![](https://i.ibb.co/Kht7GQ2/03.png)
![](https://i.ibb.co/DKZyBPP/04.png)

4. Once selected the facebook page, instagram channel and have given corresponding permissions, you must click on Generate token. 
5. After generate the token, scroll down to add the webhook. This webhook allows you to send and receive the messages between eva and instagram. Webhook should have two services: Get and post. Both of services must have the same name. 
![](https://i.ibb.co/yqYp4zF/05.png)

6. The Get service is used to answer the validation of the service, doing a two-factor authentication with a token generated by a keyword. As for the post method, it is a way to send messages to Instagram
7. Once you add webhook services (get and post) you can see the facebook pages asociated, like this: 
![](https://i.ibb.co/yqYp4zF/05.png)

9. At the end of the associated Facebook page, you will find the edit button, click and select the permissions "messages" and "messaging_postbacks": 
![](https://i.ibb.co/X7VTxt0/06.png)

With this you have configured and working your facebook.

**- Instagram Configuration**

1. We select the option Messenger> Instagram Settings
2. And we add our instagram company profile.
![](https://i.ibb.co/WG9S2Sh/07.png)

3. And we also add the webhooks in the configuration.
![](https://i.ibb.co/BNJ855Q/08.png)

**- eva Configuration**

1. The first thing is to go to our cockpit of eva.
![](https://i.ibb.co/RHGPVWW/001.png)

2. Then we go to the option "Create a bot".
![](https://i.ibb.co/k0ms9Vs/009.png)

3. To create a bot you must select.
-- Upload avatar
-- Write a name
-- Select a NLP
-- Select a Language
-- and Select a Channel > **Instagram**

![](https://i.ibb.co/TR6zL0g/003.png)

4. With the flow trained and working, we need to connect it to Instagram, for which we go to the option **Parameters**

![](https://i.ibb.co/dgtRNvq/004.png)
5. Then we select the option "Create Parameters" and start creating one by one.
**-- pageID:** Instagram Business ID.
**-- pageName:** Instagram Business Name.
**-- hubToken:** Secret word for service validation on facebook developer.
**-- pageAccessToken:** Token of the fanPage that is related to the Instagram Business account
**-- channelID:** Channel ID.
 ![](https://i.ibb.co/ZgyWmQV/005.png)
 ![](https://i.ibb.co/tHfPDwY/006.png)

**- Test connector**
1.  Having all the components connected, we only have to test our bot.
 ![](https://i.ibb.co/R7r3k3F/008.png)
